# Backend configuration for Terraform state
# Copy to backend.tf and configure for your environment

terraform {
  backend "s3" {
    # YC Object Storage configuration
    endpoint = "storage.yandexcloud.net"

    # Bucket for Terraform state (must be created manually)
    bucket = "my-terraform-state-bucket"
    key    = "yc-opennext/terraform.tfstate"
    region = "ru-central1"

    # Credentials (set via environment variables)
    # These use AWS variable names but are for Yandex Object Storage (S3-compatible)
    # export AWS_ACCESS_KEY_ID=your_yc_service_account_access_key
    # export AWS_SECRET_ACCESS_KEY=your_yc_service_account_secret_key

    # State locking via DynamoDB-compatible YDB DocAPI (optional)
    # dynamodb_endpoint = "https://docapi.serverless.yandexcloud.net/ru-central1/xxx"
    # dynamodb_table    = "terraform-locks"

    # Encryption
    encrypt = true

    # Workspace prefix
    workspace_key_prefix = "workspaces"
  }
}

# Alternative: Local backend for development
# terraform {
#   backend "local" {
#     path = "./terraform.tfstate"
#   }
# }